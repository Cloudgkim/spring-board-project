<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<body>

    <div class="container my-2">

        <h2>📋 게시글 상세 📋</h2>

        <div class="mb-3">
            <label class="form-label">번호</label>
            <input type="text" class="form-control" th:value="${post.id}" readonly>
        </div>

        <div class="mb-3">
            <label class="form-label">제목</label>
            <input type="text" class="form-control" th:value="${post.title}" readonly>
        </div>

        <div class="mb-3">
            <label class="form-label">카테고리</label>
            <input type="text" class="form-control" th:value="${post.category.name}" readonly>
        </div>

        <div class="mb-3">
            <label class="form-label">내용</label>
            <textarea class="form-control" rows="8" readonly
                      th:text="${post.content}"></textarea>
        </div>

        <div class="row">
            <div class="col-md-6 mb-3">
                <label class="form-label">작성일</label>
                <input type="text" class="form-control"
                       th:value="${#temporals.format(post.createDate, 'yyyy-MM-dd HH:mm')}"
                       readonly>
            </div>

            <div class="col-md-6 mb-3">
                <label class="form-label">수정일</label>
                <input type="text" class="form-control"
                       th:value="${#temporals.format(post.updateDate, 'yyyy-MM-dd HH:mm')}"
                       readonly>
            </div>
        </div>


        <!-- 버튼 영역 -->
        <div class="d-flex justify-content-end gap-2 mt-4">

            <a th:href="@{/}" class="btn btn-secondary">
                목록
            </a>

            <a th:if="${session.loginUser != null and session.loginUser.id == post.user.id}"
               th:href="@{/board/{id}/edit(id=${post.id})}"
               class="btn btn-primary">
                수정
            </a>

            <form th:if="${session.loginUser != null and session.loginUser.id == post.user.id}"
                  th:action="@{/board/{id}/delete(id=${post.id})}"
                  method="post">
                <button type="submit"
                        class="btn btn-danger"
                        onclick="return confirm('정말 삭제할까요?');">
                    삭제
                </button>
            </form>

        </div>

    </div>


    <!-- 댓글 -->
    <div class="">
        <h5>💬 댓글</h5>

        <div th:each="comment : ${comments}" class="border rounded p-2 mb-2">
            <strong th:text="${comment.user.username}"></strong>
            <span th:text="${comment.content}"></span>
            <div class="text-muted small"
                 th:text="${#temporals.format(comment.createDate, 'yyyy-MM-dd HH:mm')}"></div>
        </div>

        <!-- 댓글 작성 -->
        <div th:if="${session.loginUser != null}" class="mt-3">
            <form th:action="@{/board/{postId}/comment(postId=${post.id})}" method="post">
                <textarea name="content"
                          class="form-control mb-2"
                          placeholder="댓글을 입력하세요"
                          required></textarea>
                <button type="submit" class="btn btn-success">
                    댓글 작성
                </button>
            </form>
        </div>

        <div th:if="${session.loginUser == null}" class="mt-3">
            <a th:href="@{/login}">로그인</a> 후 댓글 작성이 가능합니다.
        </div>
    </div>


</body>
</html>
